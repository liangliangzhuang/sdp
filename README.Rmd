---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  message = FALSE,
  warning = FALSE,
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

<!-- badges: start -->
<!-- badges: end -->

# Overview

The goal of sdp is to provide engineers with practical guidance on how to analyze data using common degradation models: Wiener process, Gamma process, and Inverse Gaussian process. For each degradation process, we provide data simulation generation, statistical inference, and remaining useful life prognostics.


## Installation

You can install the development version of sdp from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("liangliangzhuang/sdp")
```

## Getting started 

```{r example}
library(sdp)
## basic example code
```

sdp functions fall into five main categories:

- "Simulate" which can simulate a group of degradation.

- "Inference" which contains maximum likelihood estimator (MLE) and Bayesian method.

- "Plot" which contains several visualization functions, mainly for plotting degradation paths, reliability and remaining useful life. See `plot_path()`, `RUL_plot()`,  `Reliability_plot`, `Reliability_cowplot()`, and `RUL_3D_density()`.

- "Others" which contains some useful functions. See `cumsub()`.


## Example: Simulated Data

This is a basic example which shows you how to solve a common problem.


We use `sim_dat()` to generate a simulated Wiener degradation process, where group is 6, time epoch is `t = 1:200`. We denote the parameters are $\mu = 2, \sigma = 3$. The output is a list: (i) first part of the list is the amount of degradation of the simulated data, (ii) second part is the increment of its degradation.

```{r cars}
dat = sim_dat(group = 6, t = 1:200, para = c(2,3),process = "Wiener")
str(dat)
```

Using `plot_path()` function to plot the simulated degradation data. 

```{r}
plot_path(dat[[1]])
```

The object is a ggplot, so you can add other related function to change the plot. For example, let's change the theme pattern. 

```{r}
plot_path(dat[[1]]) + theme_bw() +
  theme(panel.grid = element_blank())
```


### Inference

For this section, we provide a tutorial for parameter estimates using MLE and Bayesian methods. Both methods are integrated in the `sta_infer()` function and just need to be set in the `"method"`. 

#### MLE

The output of MLE is the dataframe contains point and interval estimates.

```{r}
mle_fit = sta_infer(method = "MLE", process = "Wiener", type = "classical", data = dat[[1]])
mle_fit
```


#### Bayes

The output of Bayes is the resampling in `rstan`. According to this object, we can do further process, e.g., prognostic, check an so on. 

```{r message=FALSE,warning=FALSE,error=FALSE}
fit1 = sta_infer(method = "Bayes", process = "Wiener",type = "classical",data = dat[[1]])
bayes_fit = rstan::summary(fit1)$summary[c(1,2),c(4,1,8)] #
bayes_fit
# print(fit1, probs = c(0.025,0.5,0.975),pars = c("mu","w"))
rstan::plot(fit1)
rstan::traceplot(fit1,pars = c("mu","w"), inc_warmup = T,nrow = 1) + theme(legend.position = "top")
```


### Reliability and RUL 

Based on the statistical inference, we use `Reliability()` and `RUL()` to calculate the Reliability and RUL, respectively. Then using  `Reliability_plot()` and `RUL_plot()` to plot.

```{r}
reb = Reliability(t = 50, threshold = 150,par = mle_fit,
                       process = "Wiener",type = "classical")
Reliability_plot(R_time = 1:150,sum_para = mle_fit,threshold = 150,
                 process = "Wiener",type = "classical")

rul = RUL(t = 1:100, cur_time = 100, threshold = 150, data = dat[[1]],
    par = mle_fit[,2], process = "Wiener", type = "classical")

RUL_plot(fut_time = c(50,55,60,65,70,75,80),time_epoch = 1:100,
                threshold = 150,zlim = c(0,0.05),xlim = c(0,100),
                para = mle_fit[,2],
                real_RUL=c(NA,NA,NA,NA,NA,NA)+40)

```



